<?php

namespace SSNepenthe\Soter\WPVulnDB;

class Vulnerability {
	public function __construct( \stdClass $vulnerability ) {
		$this->object = $vulnerability;
	}

	public function __get( $key ) {
		if ( isset( $this->object->{$key} ) ) {
			return $this->object->{$key};
		}

		return null;
	}

	public function affects_version( $version ) {
		if ( ! is_string( $version ) ) {
			throw new \InvalidArgumentException(
				'The version parameter is required to be string, was: %s',
				gettype( $version )
			);
		}

		return is_null( $this->object->fixed_in ) ||
			   version_compare( $version, $this->object->fixed_in, '<' );
	}
}
