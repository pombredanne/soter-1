<?php

namespace SSNepenthe\Soter\WPVulnDB;

class Vulnerability {
	public function __construct( \stdClass $vulnerability ) {
		$this->object = $vulnerability;
	}

	public function __get( $key ) {
		if ( isset( $this->object->{$key} ) ) {
			return $this->object->{$key};
		}

		return null;
	}

	public function affects_version( $version ) {
		return is_null( $this->object->fixed_in ) ||
			   version_compare( $version, $this->object->fixed_in, '<' );
	}
}
