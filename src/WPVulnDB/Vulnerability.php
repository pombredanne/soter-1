<?php
/**
 * Vulnerability wrapper.
 *
 * @package soter
 */

namespace SSNepenthe\Soter\WPVulnDB;

/**
 * This class defines a simple wrapper for a vulnerability reported by WPVulnDB.
 */
class Vulnerability {
	/**
	 * Vulnerability constructor.
	 *
	 * @param \stdClass $vulnerability JSON decoded vulnerability from WPVulnDB.
	 */
	public function __construct( \stdClass $vulnerability ) {
		$this->object = $vulnerability;
	}

	/**
	 * __get magic method.
	 *
	 * @param  string $key Property key.
	 *
	 * @return mixed
	 */
	public function __get( $key ) {
		if ( isset( $this->object->{$key} ) ) {
			return $this->object->{$key};
		}

		return null;
	}

	/**
	 * Determine whether this vulnerability affects a given package version.
	 *
	 * @param  string $version Package version.
	 *
	 * @return bool
	 *
	 * @throws  \InvalidArgumentException If version is not a string.
	 */
	public function affects_version( $version ) {
		if ( ! is_string( $version ) ) {
			throw new \InvalidArgumentException(
				'The version parameter is required to be string, was: %s',
				gettype( $version )
			);
		}

		return is_null( $this->object->fixed_in ) ||
			   version_compare( $version, $this->object->fixed_in, '<' );
	}
}
